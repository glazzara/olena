2006-04-26  Thierry Geraud  <theo@lrde.epita.fr>

	Add mlc_propagate_typedef_from; fix mlc::eq_ and _neq_.

	* mlc/typedef.hh (mlc_propagate_typedef_from): New macro.
	* mlc/cmp.hh (eq_, neq_): Change assertions so that it works on value
	types.

2006-04-20  Roland Levillain  <roland@lrde.epita.fr>

	* mlc/Makefile.am (nobase_mlc_HEADERS): Add missing files.
	Remove type.hh.

2006-04-11  Thierry Geraud  <theo@lrde.epita.fr>

	Fix some warnings with icpc; add is_built_in_.

	* tests (svn:ignore): Add '.deps'.
	* tests/case.cc: Fix warning with icpc.
	* tests/gcase.cc: New file.
	* mlc/abstract: New directory.
	* mlc/type.hh: Rename as...
	* mlc/abstract/type.hh: ...this.
	* mlc/bexpr.hh (abstract::bexpr): Move to...
	* mlc/abstract/bexpr.hh: ...this new file.
	* mlc/flags.hh: Update include.
	* mlc/value.hh: Update include.
	* mlc/ret.hh: Add separators in macros to fix error with icpc.
	* mlc/assert.hh: Add dtor to fix warning with icpc.
	* mlc/case.hh (internal::a_get_case): New flag.
	(get_case_): New class; it differs from case_ in remaining silent
	when no case matches.
	* mlc/cmp.hh (is_builtin_): New class with its specializations.

2006-04-04  Roland Levillain  <roland@lrde.epita.fr>

	Add mlc::any.

	* mlc/contract.hh: New (imported from Olena proto-1.0).
	* mlc/any.hh: New (imported from Olena proto-1.0).
	Aesthetic changes.
	(any__simple): New class.
	* mlc/is_a.hh (mlc_is_a, mlc_is_not_a): Use the `template' keyword
	to remove an ambiguity w.r.t the nature of the template struct
	`ret' within mlc::form::of.
	* tests/any.cc: New test.
	* tests/Makefile.am (check_PROGRAMS): Add any.
	(any_SOURCES): New.

2006-04-03  Thierry Geraud  <theo@lrde.epita.fr>

	Add protection mechanism to case definitions and update.

	* tests/switch.cc: Update.
	* tests/protected.cc: New file.
	* tests/Makefile.am (protected): New entry.
	* mlc/ret.hh (mlc_ret_, mlc_ret_found_in): New macros.
	(ret_found_in_): Update.
	* mlc/if.hh (FIXME): Remove.
	(if_): Change inheritance into composition.
	* mlc/typedef.hh: Cosmetics.
	* mlc/switch.hh (mlc_switch, mlc_switch_): New macros.
	* mlc/TODO: Update.
	* mlc/case.hh (mlc_case, mlc_case_): New macros.
	(ERROR): Update and augment.
	(WARNING): New.
	(mlc_case_equipment_for_namespace): Update to handle protected_.
	* mlc/cmp.hh (mlc_is_found, mlc_is_not_found): New macros.
	(mlc_is_undefined, mlc_is_defined): New macros.
	(mlc_is_ok, mlc_is_not_ok): New macros.
	(is_value, is_not_value): Update.
	(is_not_found_, is_found_): Update.
	(is_not_ok_, is_ok_): Update.

2006-03-27  Thierry Geraud  <theo@lrde.epita.fr>

	Remove remaining dependencies between Boolean values and exprs.

	* mlc/bool.hh (bool_): Remove inheritance from bexpr_is_.
	* mlc/bexpr.hh (bexpr_is_): Rename as...
	(bexpr_): ...this.
	(bexpr_<b>::bexpr): New typedef so that bexprs can be simplified.
	* tests/if.cc: Update.
	* mlc/logic.hh: Add macros; add static checks; update.
	* mlc/if.hh: Add static check.
	* mlc/implies.hh: Add static check and update.
	* mlc/abort.hh: Update.
	* mlc/is_a.hh (where_): Add static check.
	Update.
	* mlc/case.hh: Update.
	* mlc/cmp.hh: Update.

2006-03-24  Thierry Geraud  <theo@lrde.epita.fr>

	Add mlc::abort_ for use in invalid code blocks.

	* mlc/abort.hh: New.
	* mlc/TODO: Update.

2006-03-23  Roland Levillain  <roland@lrde.epita.fr>

	* tests/ret.cc (main): Don't write test results on the standard
	output.

2006-03-22  Thierry Geraud  <theo@lrde.epita.fr>

	Tiny fix.

	* mlc/logic.hh: Fix missing include.

2006-03-22  Thierry Geraud  <theo@lrde.epita.fr>

	Re-enable or_list_ and and_list_.

	* tests/or.cc: New file.
	* tests/Makefile.am: Update.
	* mlc/logic.hh (or_list_, and_list_): Uncomment, update, and bug fix.
	* mlc/assert.hh: Fix missing include.

2006-03-21  Thierry Geraud  <theo@lrde.epita.fr>

	Disambiguate Boolean value types and Boolean expression types.

	* tests/ret.cc: Update.
	* mlc/ret.hh: Fix missing include.

	The Boolean value classes are re-written and internal::value_ is
	removed; this class was too ambiguous since precise types, e.g.,
	int_<i>, are provided and it was weirdly located in the value class
	hierarchy.

	* mlc/bool.hh (bool_<true>, bool_<false>): Merge those
	specializations into the single and once for all written class
	bool_<b>.
	(bool_<true>::is_true): Remove since this mark is now factored
	in the base class bexpr_is_<b>.
	(bool_<b>): Add inheritance so that a Boolean value can be
	considered as a Boolean expression type.
	(internal::value_<bool, b>): Remove this specialization since
	the class internal::value_ is also removed.
	(logic.hh): Remove inclusion.
	(mlc_bool): Move to...

	The Boolean expression types are now handled by special classes.
	Yet mlc::true_ and mlc::false_ remain expression types in addition
	of value types.

	* mlc/bexpr.hh: ...this file.  This macro only applies on Boolean
	expression types.
	(bexpr_): Remove this obsolete wrapper.
	(bexpr_is_<b>): New base class with its couple of specializations
	which act as a replacement for bool_<b> for expression types.
	(internal::bool_of_): Replace the meta-code for mlc_bool.

	Those changes induce a lot of updates described below.

	* mlc/pair.hh: Update includes.
	* mlc/logic.hh: Update.  Instead of deriving from bool_<b>
	Boolean expression types now derive from bexpr_is_<b>.
	(and_list_, or_list_): Comment to postpone updating while keeping
	code compile.
	* mlc/implies.hh: Update inheritance.
	* mlc/if.hh: Update includes and add assertion.
	* mlc/assert.hh: Update includes.
	* mlc/valist.hh: Likewise.
	* mlc/wrap.hh: Remove obsolete code.
	* mlc/is_a.hh: Update inheritance.
	(bexpr_): Replace by wrap_.
	* mlc/case.hh: Update.  Now use mlc_bool instead of ::value.
	* mlc/cmp.hh: Update inheritance.
	(eq_::ensure): Remove this obsolete feature.
	* mlc/value.hh: Move sub-classes of value to...
	* mlc/int.hh, mlc/char.hh: ...these new files.
	* mlc/values.hh: New file that includes the whole value types material.

2006-03-21  Thierry Geraud  <theo@lrde.epita.fr>

	First step towards explicit bexpr.

	* mlc/bool.hh: Fix doc typo.
	* mlc/TODO: Update.
	* mlc/wrap.hh (unwrap): Remove cause useless.
	(value_wrap_, boolean_wrap_): New dedicated wrappers.
	* mlc/bexpr.hh: New file. It provides an explicit wrapper for Boolean
	expression types; it is a first step towards the disambiguation between
	the Boolean value type and the many Boolean expression types.
	* mlc/is_a.hh (mlc_is_a): Update; now use bexpr_ instead of wrap_.
	* mlc/value.hh (mlc_value): Suggest this macro.

2006-03-21  Thierry Geraud  <theo@lrde.epita.fr>

	Create assert.hh from bool.hh contents.

	* mlc/bool.hh (mlc_type_iff, mlc::type_iff_): Remove cause soon obsolete.
	(bool_<true>::ensure()): Remove to force the client to use assert_.
	(bool_): Add using clauses to make contents explicit.
	(internal::check_, internal::check_item_): Move to...
	(literal_, no_error_message, no_bexpr): Move to...
	(assert_, multiple_assert_): Move to...
	* mlc/assert.hh: ... this new file.
	* tests/is_a.cc: Update.
	* tests/if.cc: Update.
	* tests/typedef.cc: Update.
	* mlc/logic.hh: Update.

2006-03-14  Roland Levillain  <roland@lrde.epita.fr>

	Catch up with recent changes and fix some tests of Metalic.

	* mlc/properties.hh (mlc_equip_namespace_with_properties):
	Catch up with recent changes in typedef.hh/ret.hh.
	Don't declare a local `ret' typedef; include mlc/ret.hh, and use
	the `mlc_ret' macro instead.
	* mlc/cmp.hh (eq_<T, T>): Solve ambiguous calls to
	ensure().
	* tests/ret.cc: Include mlc/ret.hh instead of
	mlc/typedef.hh.

2006-03-10  Thierry Geraud  <theo@lrde.epita.fr>

	Minor addition.

	* mlc/comma.hh: Add version for 4 commas.

2006-03-07  Thierry Geraud  <theo@lrde.epita.fr>

	Some non significative update.

	* mlc/ret.hh (typedef_::ret): Move from namespace global to mlc and
	update file contents.
	* mlc/bool.hh (assert_::ensure): New method so that the user can form
	"assert_<bexpr, error_msg>::ensure();"
	* mlc/TODO: New.

2006-03-03  Thierry Geraud  <theo@lrde.epita.fr>

	Update Makefiles and switch file.

	* tests/Makefile.am: Update.
	* mlc/switch.hh: Replace obsolete contents by inclusion of case.hh.
	* mlc/Makefile.am: Update.

2006-03-02  Thierry Geraud  <theo@lrde.epita.fr>

	Add meta switch-case; disambiguate typedef_.

		"typedef exists but its value is not_found" and "typedef is
		not found because it does not exist".

	* tests/case.cc: New file.
	* tests/switch.cc (where_): Precise name.
	* tests/ret.cc: New file.
	* mlc/bool.hh (assert): Remove is_true to avoid cryptic error
	message such as "is_true" inaccessible.
	* mlc/flags.hh (found): New class.
	* mlc/typedef.hh (result2): New inner class to disambiguate between
	"typedef is found but its value is not_found" and "typedef is not
	found".
	(mlc_ret, mlc_decl_typedef(ret)): Move to...
	* mlc/ret.hh: ...this new file.
	* mlc/switch.hh: Change that makes this file soon obsolete.
	* mlc/case.hh: New file.

2006-02-20  Roland Levillain  <roland@lrde.epita.fr>

	Revamp the virtual types (aka properties) system.

	No longer use the C++'s inheritance mechanism to ``pack'' the
	internal vtypes of a class.  Rely on a metacode algorithm to
	recursively look for vtypes in internal and external vtypes
	instead, using both the super link and a ``pseudosuper'' link to
	visit the upper classes.  The set/get classes have been replaced
	by a single class (in fact, by two classes, one for internal
	vtypes, the other for external vtypes).  The pseudosuper link is
	used to inherit (or fetch) the vtypes from a given class, without
	needing to inherit from this class.

	* mlc/properties.hh (mlc_equip_namespace_with_properties):
	Rewrite this macro.
	(set_types, set_ext_types): Rename as...
	(vtypes, ext_vtypes): ...this.
	(get_types, get_ext_type): Remove.
	* tests/properties.cc: Update the test.
	Check for new cases (external vtype, pseudo inheritance of
	vtypes).
	(rec_get_vtype, rec_get_ext_vtype): New.
	This class holds the algorithm for the recursive retrieval of
	internal/external vtypes.
	(typeof_): Adjust.

2006-02-17  Thierry Geraud  <theo@lrde.epita.fr>

	Enhance error handling in mlc::switch_.

	* tests/switch.cc: New file.
	* mlc/switch.hh (case_true, case_false): New classes.
	(case_type): New typedef in classes.
	(case_, switch_): Modify error handling.

2006-02-17  Thierry Geraud  <theo@lrde.epita.fr>

	Modify mlc::assert_ to handle explicit error messages; also.

	* mlc/elt.hh: Fix bug.
	* mlc/pair.hh: Add explicit error messages.
	* mlc/valist.hh: Likewise.
	* mlc/bool.hh (ASSERTION_FAILED_, AN_ASSERTION_FAILED_): Remove
	so that error messages are more concise.
	(iff_, mlc_iff): Rename as...
	(type_iff_, mlc_type_iff): ...these.
	(assert_): Update.
	* mlc/switch.hh: New.
	* mlc/is_a.hh (internal::is_a): Move and rename as...
	(is_a_): ...this so error messages are shortern.
	* mlc/cmp.hh: Pretty print.

2006-02-16  Roland Levillain  <roland@lrde.epita.fr>

	Switch to the new properties system.

	* mlc/properties.hh: Switch to the new properties system.
	* tests/properties.cc: Adjust test.

2006-02-16  Thierry Geraud  <theo@lrde.epita.fr>

	Replace ensure_ (ensure_list_) with assert_ (multiple_assert_).

	* tests/properties.cc: Fix bug to get compatibility with g++-3.3.
	* mlc/bool.hh (ensure_item_<i, expr, check>): Rename as...
	(check_item_<i, bexpr, result>): ...this.
	(check_<bexpr, result>): New class dedicated to assert_.
	(retrieve_ensure_): Remove.
	(ASSERTION_FAILED_, AN_ASSERTION_FAILED_): New internal classes
	mimicking respectively the old ensure_ and ensure_list_.
	(no_error_message, no_bexpr): New classes.
	(ensure_, ensure_list_): Rename as...
	(assert_, multiple_assert_): ...these.
	* mlc/pair.hh: Update.
	* mlc/logic.hh: Update.
	* mlc/valist.hh: Update.
	* mlc/implies.hh: Update.
	* mlc/is_a.hh: Update.
	* mlc/cmp.hh: Update.

2006-02-15  Thierry Geraud  <theo@lrde.epita.fr>

	Add new features such as variadic type list.

	* mlc/elt.hh: New file.
	* mlc/bool.hh (iff_): New class.
	* mlc/pair.hh: New file.
	* mlc/valist.hh: New file.
	* mlc/cmp.hh: Update.
	* mlc/uint.hh: New file.

2006-02-15  Thierry Geraud  <theo@lrde.epita.fr>

	Split bool.hh to move logical ops in an independant file.

	* mlc/bool.hh: Move logical ops in...
	* mlc/logic.hh: this new file.
	(ors_, ands_): Rename as...
	(or_list_, and_list_): ...these.

2006-02-14  Roland Levillain  <roland@lrde.epita.fr>

	Add the old properties system.

	* tests/properties.cc, mlc/to_string.hh: New files.
	* mlc/properties.hh: New test.

2006-02-14  Roland Levillain  <roland@lrde.epita.fr>

	Fix mlc::is_ok definition.

	* mlc/cmp.hh (mlc::is_ok): Add missing template declarator.

2006-02-14  Roland Levillain  <roland@lrde.epita.fr>

	Add tests for mlc_is_a, mlc_if and mlc_typedef.

	* tests/is_a.cc, tests/if.cc, tests/typedef.cc: New tests.

2006-02-14  Roland Levillain  <roland@lrde.epita.fr>

	Add some documentation and types to Metalic.

	* mlc/cmp.hh: More documentation.
	(is_found, is_not_found, is_ok): New.
	* mlc/implies.hh, mlc/is_a.hh: Fix Doxygen comment.
	* mlc/flags.hh: More documentation.
	(dummy, locked): New.
	From Thierry Géraud.
	* mlc/value.hh: Remove dead code.

2006-02-10  Thierry Geraud  <theo@lrde.epita.fr>

	Add implies, comma, typedef ret handling; then update.

	* mlc/implies.hh: New file.
	* mlc/is_a.hh: Update.
	* mlc/comma.hh: New file.
	* mlc/typedef.hh (in_, in_onlyif_): Rename as...
	(from_, from_only_if_): ...this.
	(mlc_typedef_in, mlc_typedef_in_): New macros.
	(mlc_ret): New macro.

2006-02-09  Thierry Geraud  <theo@lrde.epita.fr>

	Modify slightly the ensure_ and ensure_list_ tools.

	* mlc/wrap.hh (wrap): Rename into...
	(wrap_): ...this.
	* mlc/bool.hh (ensure_item): Rename into...
	(ensure_item_): ...this and add a parameter to ease disambiguation.
	(ensure_list_): Update.
	(documentation): Update.
	* mlc/cmp.hh: Update.

2006-02-07  Thierry Geraud  <theo@lrde.epita.fr>

	Add documentation.

	* mlc/is_a.hh (wrap): Move to...
	* mlc/wrap.hh: ...this new file.
	* mlc/bool.hh (ensure_): Take just one parameter; the former variadic
	version is now handled by...
	(ensure_list_): ...this new class.
	* mlc/typedef.hh: Rename some internals.

2006-01-26  Roland Levillain  <roland@lrde.epita.fr>

	Static `if'.

	* mlc/if.hh: New file.

2006-01-26  Thierry Geraud  <theo@lrde.epita.fr>

	Add mlc::ensure_ and update. .

	* mlc/bool.hh: Update documentation.
	(internal::value_<bool,b>::ret): Rename as...
	(internal::value_<bool,b>::eval): ...this.
	(bool_<true>::ensure_t): Rename as...
	(bool_<true>::internal_ensure_): ...this.
	(internal::ensure_item<i,expr>): New class.
	(internal::none_): Relocate.
	(internal::none_::internal_ensure_): New typedef.
	(ensure_): New class.
	* mlc/value.hh (is_value, is_not_value): Move to...
	* mlc/cmp.hh (is_value, is_not_value): ...here.
	(eq_, neq_): Update static checks.

2006-01-25  Thierry Geraud  <theo@lrde.epita.fr>

	Clean up of core mlc classes and add some documentation.

	A lot of cleanups.  Client concrete classes in mlc are now all
	postfixed by '_'.  For instance, we have and_, int_, and so on.

	* .: New.
	* mlc: New.
	* mlc/type.hh: New.
	* mlc/bool.hh: New.
	(abstract::boolean): New class.
	(bool_): New class.
	(value, true_type, false_type): Rename as...
	(value_, true_, false_): ...these.
	(ors, ands): Rename as...
	(ors_, ands_): ...these.
	(internal): Cosmetic change.
	(is_true, is_false): Remove.
	(true_, false_): New typedef ensure_t.
	* mlc/is_a.hh: New.
	(form): Move in the internal namespace cause names are too long
	for a decent client use.
	* mlc/value.hh: New.
	(value): Rename as...
	(value_): ...this.
	(mlc_internal_decl_unsigned_): New macro.
	(mlc_internal_decl_signed_): New macro.
	(uchar_, ushort_, uint_, ulong_): New classes.
	(schar_, short_, int_, long_): New classes.
	(is_value, is_not_value): New meta-functions.
	* mlc/flags.hh: New.
	(flag): New abstract class.
	(undefined_type, unknown_type, no_type): Rename as...
	(undefined, unknown, none): ...these.
	(not_ok): Remove cause useless.
	* mlc/cmp.hh: New.
	(eq, neq): Rename as...
	(eq_, neq_): ...these.
	(is_found, is_not_found, is_ok): Remove cause irrelevant here.
	(mlc_is_found, mlc_is_not_found): Likewise.
	* mlc/typedef.hh: New.
